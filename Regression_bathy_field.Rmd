---
title: "Validation of Cairns_Cooktown's EOMAP depth layers derived from Landsat and Sentinel vs acoustic validation data"
name: Rodney Borrego Acevedo
output: html_document
---

```{r loading paks, include=FALSE}

library(dplyr)
library(mgcv)
library(ggplot2)
library(MuMIn)
library(Cairo)
library(gridExtra)
library(tidyverse)

```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

1. EOMAP depth validation

This document shows regression plots between EOMAP depth layer derived from Landsat (EOMAP_Landsat) vs acoustic validation data and EOMAP depth layer derived from Sentinel (EOMAP_Sentinel) vs acoustic validation data. The figure below shows the location of acoustic validation data.


![](20190214_TideDoveData_EOMAP.jpg)


Fig. 1. Location of acoustic data collected in Cairns-Cooktown (GBR)

'Comparison EOMAP landsat depth vs acoustic data'


```{r, echo=FALSE}

## bring data
EOMAP_data <- read.csv("Z:/Australia/GBR/cairns_cook/Processing/depth_profiles/GBR_bathyfield/cc_Bathy_EOMAPSent/Acoustic_validation_L8vsSent.csv", header=T, stringsAsFactors=F)
##str(EOMAP_data) ##data type  
## isolating data for regress, getting the right columns
dataPrep <- select(EOMAP_data, Depth,SDB_10m, SDB_15m) ## select create a new dataframe with the columns of interest
##head(dataPrep)
RegressionDataset <- dataPrep %>% 
  mutate_if(is.numeric, round, 2) 
## getting rid of the -9999.000
EOMAP_clean <- filter(RegressionDataset, Depth != 0, SDB_10m != -9999.00, SDB_15m != -9999.00)
## change sign in depth readings
EOMAP_to_regress <- mutate(EOMAP_clean, Depth =Depth*(-1))
Acoustic.readings <- EOMAP_to_regress$Depth
EOMAP.Landsat.Depth <- EOMAP_to_regress$SDB_15m
EOMAP.Sentinel.Depth <- EOMAP_to_regress$SDB_10m

fit <- lm(EOMAP.Landsat.Depth ~ Acoustic.readings)
fit2 <-lm(EOMAP.Sentinel.Depth ~ Acoustic.readings)

## these lines are to produce the plots
##R2Plot<-ggplot(EOMAP_to_regress,aes(x=Acoustic.readings,y=EOMAP.Landsat.Depth))+geom_point()+scale_y_reverse()+scale_x_reverse()+geom_line(data=fortify(fit), color='Red', aes(x =Acoustic.readings, y = .fitted))

##R2Plot<-ggplot(EOMAP_to_regress,aes(x=Acoustic.readings,y=EOMAP.Landsat.Depth))+geom_point()+scale_y_reverse()+scale_x_reverse()+stat_smooth(method = "lm", col = "red")
  
##R2Plot

##geom_smooth(method = "lm", se=TRUE)
##?geom_smooth
##summary(fit)

## function to get the regression annotation over the plot

ggplotRegression <- function (fit) { ## got the function from here https://sejohnston.com/2012/08/09/a-quick-and-easy-function-to-plot-lm-results-in-r/

require(ggplot2)

ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) + 
  geom_point() +
  stat_smooth(method = "lm", col = "red") +
  labs(title = paste("Coeff of Determination (R^2) = ",signif(summary(fit)$adj.r.squared, 5),
                     "Intercept =",signif(fit$coef[[1]],5 ),
                     " Slope =",signif(fit$coef[[2]], 5)))
#,
                     #" P =",signif(summary(fit)$coef[2,4], 5)))

}

ggplotRegression(fit)



ggplotRegression(fit2)




